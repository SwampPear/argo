llm:
  provider: "local"
  allow_internet_access: false
  max_context_tokens: 32000

program:
  client: "acme"
  contact: "security@acme.shop"
  notes: "Follow the program's Safe-Harbor rules. No testing of 3rd-party services unless explicitly listed."

rules:
  allowed_http_methods: [GET, HEAD, OPTIONS, POST, PUT, PATCH, DELETE]
  destructive_actions_forbidden: true
  auth_bruteforce_forbidden: true
  dos_forbidden: true
  captcha_policy: "manual"
  max_request_body_kb: 256

compliance:
  safe_harbor: true
  logging:
    immutable_audit_log: true
    include_request_bodies: true
    include_response_bodies: true
  notifications:
    on_violation: ["slack://sec-team", "email://security@acme.shop"]
    on_completion: ["email://security@acme.shop"]

rate_limits:
  global:
    requests_per_minute: 60
    concurrent_requests: 5
  per_host:
    - host: "app.acme.shop"
      requests_per_minute: 20
      concurrent_requests: 2
    - host: "api.acme.shop"
      requests_per_minute: 30
      concurrent_requests: 3

assets:
  in_scope:
    - mode: web
      hostname: app.acme.shop
      paths: ["/", "/account/**", "/orders/**"]
    - mode: api
      hostname: api.acme.shop
      schemes: ["https"]
      ports: [443]
      paths: ["/v1/**"]
    - mode: mobile-api
      hostname: m.acme.shop
      paths: ["/v2/**"]
  out_of_scope:
    - mode: third_party
      description: "Payment processor pages hosted on pay.example.com"
    - mode: marketing
      hostname: www.acme.shop
      paths: ["/blog/**", "/careers/**"]
    - mode: support
      hostname: help.acme.shop

authentication:
  allowed: true
  test_accounts_provided: true
  accounts:
    - username: tester1@acme.shop
      role: customer
      password: "VAULT:acme/tester1"
    - username: tester2@acme.shop
      role: customer
      password: "VAULT:acme/tester2"
