program:
  client: "acme"
  contact: "security@acme.shop"
  notes: "Follow the program's Safe-Harbor rules. No testing of 3rd-party services unless explicitly listed."

rules:
  allowed_http_methods: [GET, HEAD, OPTIONS, POST, PUT, PATCH, DELETE]
  destructive_actions_forbidden: true # never run exploits that modify data at scale
  auth_bruteforce_forbidden: true     # never run expnesive brute force operations
  dos_forbidden: true                 # includes rate abuse and resource exhaustion
  captcha_solving: "manual_only"      # never auto-bypass unless program allows
  max_request_body_kb: 256            # guard against oversized payloads

compliance:
  safe_harbor: true
  logging:
    immutable_audit_log: true
    include_request_bodies: true
    include_response_bodies: true
  notifications:
    on_violation: ["slack://sec-team", "email://security@acme.shop"]
    on_completion: ["email://security@acme.shop"]

rate_limits:
  global:
    requests_per_minute: 60
    concurrent_requests: 5
  per_host:
    "app.acme.shop":
      requests_per_minute: 20
      concurrent_requests: 2
    "api.acme.shop":
      requests_per_minute: 30
      concurrent_requests: 3

crawling:
  start_urls:
    - "https://app.acme.shop/"
  respect_robots_txt: true
  max_depth: 3
  same_origin_only: true
  include_patterns: ["**/account/**", "**/orders/**"]
  exclude_patterns: ["**/logout", "**/delete**"]

assets:
  in_scope:
    - type: web
      hostname: app.acme.shop
      paths: ["/", "/account/**", "/orders/**"]
    - type: api
      hostname: api.acme.shop
      schemes: ["https"]
      ports: [443]
      paths: ["/v1/**"]
    - type: mobile-api
      hostname: m.acme.shop
      paths: ["/v2/**"]
  out_of_scope:
    - type: third_party
      description: Payment processor pages hosted on pay.example.com
    - type: marketing
      hostname: www.acme.shop
      paths: ["/blog/**", "/careers/**"]
    - type: support
      hostname: help.acme.shop

authentication:
  allowed: true
  test_accounts_provided: true
  accounts:
    - username: tester1@acme.shop
      role: customer
      password_secret_ref: VAULT:acme/tester1
    - username: tester2@acme.shop
      role: customer
      password_secret_ref: VAULT:acme/tester2
  mfa:
    type: totp
    secret_ref: VAULT:acme/totp-shared
  session_policies:
    reuse_sessions: false          # fresh login per run unless explicitly allowed
    logout_after_tests: true

